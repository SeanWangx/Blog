## DNS解析逻辑

> 2020.04.15

### 域名层次结构

1. 根域名 `.`
2. 顶级域名 `.com`
3. 二级域名 `qq.com`
4. 子域名 `www.qq.com`

### 过程

1. 查询浏览器本身是否有缓存，即域名对应的地址，有则使用缓存；
2. 浏览器缓存未命中，查询本地域名服务器是否有缓存，有则使用；
3. 向DNS域名服务器查询，方式可分为 **递归查询** 和 **迭代查询**两种

#### 迭代查询

1. 本地域名服务器向根域名发送解析请求
2. 根域名服务器向顶级域名服务器发送请求
3. 顶级域名服务器向二级域名服务器发送请求
4. 二级域名服务器返回给二级域名服务器解析结果
5. 二级域名服务器向顶级域名服务器返回解析结果
6. 顶级域名服务器向根域名服务器返回解析结果
7. 根域名服务器向本地域名服务器返回解析结果
8. 本地域名服务器获取到解析的ip地址

总结就是本地域名服务器从根域名服务器获取到解析结果。

### 递归查询

1. 本地域名服务器向根域名服务器发送解析请求，服务器返回目标顶级域名服务器地址
2. 本地域名服务器向目标顶级域名服务器发送解析请求，顶级服务器返回目标二级域名服务器地址
3. 本地域名服务器向目标二级域名服务器发送解析请求，二级域名服务器返回目标子域名服务器地址
4. 本地域名服务器向目标子域名服务器发送解析请求，子域名服务器返回解析结果
5. 本地域名服务器获取到解析的ip地址

总计就是本地域名服务器最终从子域名服务器获取到解析结果。
