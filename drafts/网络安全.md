## 网络安全

> 2020.04.18

### XSS

XSS(Cross Site Script) —— 跨站脚本攻击，核心在于页面被注入了恶意代码（脚本），按照注入的方式可以分为存储型、反射型、基于DOM三种。

| 类型 | 存储区            | 插入点 | 操作对象 |
|:-----:|:--------------:|:-----:|:------------------:|
| 存储型 | 后端数据库       | HTML | 服务器拼接HTML给浏览器 |
| 反射型 | URL            | HTML | 服务器拼接HTML给浏览器 |
| 基于DOM | 后端数据库/前端存储/URL | JavaScript | 前端执行触发 |


#### 存储型

恶意脚本来源于服务器数据库，由攻击者向数据库注入了恶意脚本，在用户访问页面需要用到后端数据时，恶意脚本随数据返回并自动加载发起攻击。

比如攻击者向评论网站输入了带恶意脚本的评论信息并被存储到了服务器中，其他用户访问网站加载评论时候就自动加载恶意脚本，受到攻击。

#### 反射型

服务器从URL获得数据，拼接到HTML交给浏览器后，浏览器加载触发

#### 基于DOM

恶意脚本来源于DOM，主要发生在前端交互中，如直接将用户输入内容渲染到网页上。

#### 概括及解决方案

上述三种方式都有共同的两个特点：

1. 对于用户输入的内容没有做过滤、转义，信任了用户的输入；
2. 对于加载资源没有做控制

针对第一条，需要开发者在开发的时候对于输入内容做好过滤、转义操作，如React之类的框架有默认帮助开发者做了过滤和转义，但是像富文本编辑器渲染到页面上，React使用dangerouslySetInnerHTML实现功能，这里存在被攻击的风险点。

针对第二点可以

### CSRF

场景：

1. 用户登陆a.com
2. 诱使用户跳转b.com
3. b.com中请求a.com/act
4. a.com是登陆状态，允许执行操作
5. 攻击成功

特点：

1. 第三方域
2. cookie等个人信息只能使用，不能拥有

措施：

1. 同源检测：禁止外域/非信任域名的请求，header中对应有Origin Header和Referer Header
